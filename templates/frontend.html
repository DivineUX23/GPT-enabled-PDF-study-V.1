<!DOCTYPE html>
<html>
    <head>
        <title>PDF Text Extraction and Summary</title>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>


      body {
                background-color: #FFFFFF;
                font-family: Arial, sans-serif;
                color: black;
                padding-bottom: 100px;
            }

            .headling {
                text-align: center;
                background-color: #3a4c40;
                box-shadow: rgba(0, 0, 0, 0.15) 0px 3px 3px 0px;
                top padding: 0%;
                color: white;
            }

            #pdf-form {
                box-shadow: rgba(0, 0, 0, 0.06) 0px 2px 4px 0px inset;                padding: 10px;
                font-size: 14px;

            }


            label, input[type='submit'] {
                margin: none;
            }

            #pdf_file {
                margin-bottom: 10px;
            }

            .alert {
                background-color: #e6f2ff;
                border: 1px solid #99ccff;
                padding: 20px;
                border-radius: 10px;
                margin-bottom: 20px;
            }


            /* Style for the conversation form */
            #conversation-form {
                position: fixed;
                bottom: 0;
                width: 80%;
                border: none;
                padding: 10px;
                left: 10%

            }

            input[type=text] {
                width: 95%;
                padding: 12px 20px;
                margin: 5px 0;
                box-sizing: border-box;
                border-radius: 10px;
                background-color: #c2fbd7;
                color: green;
            }

            /* Style for the conversation history */
            #conversation-history {
                font-size: 16px;
                margin: 0px 10%;
            }


            /* CSS */
            #button-33 {
              background-color: #c2fbd7;
              border-radius: 100px;
              box-shadow: rgba(44, 187, 99, .2) 0 -25px 18px -14px inset,rgba(44, 187, 99, .15) 0 1px 2px,rgba(44, 187, 99, .15) 0 2px 4px,rgba(44, 187, 99, .15) 0 4px 8px,rgba(44, 187, 99, .15) 0 8px 16px,rgba(44, 187, 99, .15) 0 16px 32px;
              color: green;
              cursor: pointer;
              display: inline-block;
              font-family: CerebriSans-Regular,-apple-system,system-ui,Roboto,sans-serif;
              padding: 7px 20px;
              text-align: center;
              text-decoration: none;
              transition: all 250ms;
              border: 0;
              font-size: 16px;
              user-select: none;
              -webkit-user-select: none;
              touch-action: manipulation;
            }

            #button-33:hover {
              box-shadow: rgba(44,187,99,.35) 0 -25px 18px -14px inset,rgba(44,187,99,.25) 0 1px 2px,rgba(44,187,99,.25) 0 2px 4px,rgba(44,187,99,.25) 0 4px 8px,rgba(44,187,99,.25) 0 8px 16px,rgba(44,187,99,.25) 0 16px 32px;
              transform: scale(1.05) rotate(-1deg);
            }





            #myButton {
              background-color: FF0000;
              border-radius: 100px;
              box-shadow: rgba(44, 187, 99, .2) 0 -25px 18px -14px inset,rgba(44, 187, 99, .15) 0 1px 2px,rgba(44, 187, 99, .15) 0 2px 4px,rgba(44, 187, 99, .15) 0 4px 8px,rgba(44, 187, 99, .15) 0 8px 16px,rgba(44, 187, 99, .15) 0 16px 32px;
              color: red;
              cursor: pointer;
              display: inline-block;
              font-family: CerebriSans-Regular,-apple-system,system-ui,Roboto,sans-serif;
              padding: 3px 16px;
              text-align: center;
              text-decoration: none;
              transition: all 250ms;
              border: 0;
              font-size: 12px;
              user-select: none;
              -webkit-user-select: none;
              touch-action: manipulation;
            }

            #myButton:hover {
              box-shadow: rgba(44,187,99,.35) 0 -25px 18px -14px inset,rgba(44,187,99,.25) 0 1px 2px,rgba(44,187,99,.25) 0 2px 4px,rgba(44,187,99,.25) 0 4px 8px,rgba(44,187,99,.25) 0 8px 16px,rgba(44,187,99,.25) 0 16px 32px;
              transform: scale(1.05) rotate(-1deg);
            }






    </style>
    </head>
    <body>
        <div class="headling">
        <p>Why read the whole Book (PDF)?!</p>
        <h3>...Find what you're looking for here ⬇️</h3>
        <p font-size: 8px;>(in 43sec or less)<p>

        <form id="pdf-form" action="/" method="post" enctype="multipart/form-data">
            <label for="pdf_file"></label>
            <input type="file" id="pdf_file" name="pdf_file" accept="application/pdf">
            <input id="button-33" type="submit" value="Open">
            <button id="myButton" onclick="removeFile()">Remove Book</button>

        </form>


    </div>
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="alert alert-info">
            <ul>
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        {% endwith %}
        <div>
            <p>
                {% for text in extracted_text %}
                {{ pdf_path }}<br>
                {% endfor %}
              </p>
        </div>
        {% if bot_response %}
            <div id="conversation-history">
                {% for message in conversation_history %}
                <p>{{ message }}</p>
                {% endfor %}
            </div>
        {% endif %}
        <form id="conversation-form" action="/conversation" method="post">
            <br>
              <br>
              <input type="text" id="user_input" name="user_input" placeholder= "Ask me anything">

              <input id="button-33" type="submit" value="Ask" style = "display:inline-block">
          </form>
          <script>
          $(document).ready(function(){
            // Handle form submission
            $("#form").submit(function(event){
              event.preventDefault();
              var userInput = $("#user-input").val();
              // Make the AJAX call to the server
              $.ajax({
                type: "POST",
                url: "/conversation",
                data: { user_input: userInput },
                success: function(response){
                  // Append the AI's response to the conversation
                  $("#conversation-history").append("<p>AI: " + response.bot_response + "</p>");
                  // Clear the input field
                  $("#user-input").val("");
                }
              });
            });
          });


    document.getElementById("myButton").addEventListener("click", function(){
        if (confirm("Are you sure you want to delete the data?")) {
            fetch('/clear_data', {
                method: 'DELETE'
            })
            .then(response => {
                if (response.ok) {
                    // Data deleted successfully
                    alert("Removal cancelled");
                } else {
                    // Error deleting data
                    alert("Removed successfully");
                }
            })
            .catch(error => {
                console.log(error);
                alert("Error deleting data");
            });
        }
    });

      </script>
    </body>
</html>

